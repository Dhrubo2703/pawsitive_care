{% extends 'base.html' %}
{% load static %}

{% block title %}

{{ title }} - Pawsitive Care{% endblock %}

{% block content %}
<div class="container-fluid py-4">
  <!-- Page Header -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="d-flex justify-content-between align-items-center">
        <h1 class="h3 mb-0">
          <i class="fas fa-boxes text-primary me-2"></i>
          {{ title }}
        </h1>
        <div>
          <a href="{% url 'inventory:item_create' %}" class="btn btn-primary me-2">
            <i class="fas fa-plus"></i> Add Item
          </a>
          <a href="{% url 'inventory:reports' %}" class="btn btn-outline-secondary">
            <i class="fas fa-chart-bar"></i> Reports
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Statistics Cards -->
  <div class="row mb-4">
    <div class="col-md-3">
      <div class="card bg-primary text-white">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <div>
              <h5 class="card-title">Total Items</h5>
              <h2 class="mb-0">
                {{ stats.total_items }}
              </h2>
            </div>
            <div class="align-self-center">
              <i class="fas fa-boxes fa-2x opacity-75"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card bg-warning text-white">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <div>
              <h5 class="card-title">Low Stock</h5>
              <h2 class="mb-0">
                {{ stats.low_stock_items }}
              </h2>
            </div>
            <div class="align-self-center">
              <i class="fas fa-exclamation-triangle fa-2x opacity-75"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card bg-danger text-white">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <div>
              <h5 class="card-title">Out of Stock</h5>
              <h2 class="mb-0">
                {{ stats.out_of_stock_items }}
              </h2>
            </div>
            <div class="align-self-center">
              <i class="fas fa-times-circle fa-2x opacity-75"></i>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <div class="card bg-success text-white">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <div>
              <h5 class="card-title">Total Value</h5>
              <h2 class="mb-0">$
                {{ stats.total_value|floatformat:2 }}
              </h2>
            </div>
            <div class="align-self-center">
              <i class="fas fa-dollar-sign fa-2x opacity-75"></i>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions & Alerts -->
  <div class="row mb-4">
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">
            <i class="fas fa-exclamation-triangle text-warning me-2"></i>
            Items Needing Attention
          </h5>
        </div>
        <div class="card-body p-0">
          {% if low_stock_items or expiring_items %}
          <div class="list-group list-group-flush">
            {% for item in low_stock_items %}
            <div class="list-group-item d-flex justify-content-between align-items-center">
              <div>
                <strong>
                  {{ item.name }}</strong>
                <br>
                <small class="text-muted">
                  {{ item.sku }}</small>
              </div>
              <span class="badge bg-warning">
                Low Stock:
                {{ item.quantity }}
              </span>
            </div>
            {% endfor %}

            {% for item in expiring_items %}
            <div class="list-group-item d-flex justify-content-between align-items-center">
              <div>
                <strong>
                  {{ item.name }}</strong>
                <br>
                <small class="text-muted">Expires:
                  {{ item.expiry_date }}</small>
              </div>
              <span class="badge bg-danger">
                Expiring Soon
              </span>
            </div>
            {% endfor %}
          </div>
          {% else %}
          <div class="p-3 text-center text-muted">
            <i class="fas fa-check-circle fa-2x mb-2"></i>
            <p class="mb-0">All items are in good condition!</p>
          </div>
          {% endif %}
        </div>
        <div class="card-footer">
          <a href="{% url 'inventory:item_list' %}?low_stock=1" class="btn btn-sm btn-outline-warning me-2">
            View Low Stock
          </a>
          <a href="{% url 'inventory:item_list' %}?expiring=1" class="btn btn-sm btn-outline-danger">
            View Expiring
          </a>
        </div>
      </div>
    </div>

    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">
            <i class="fas fa-history text-info me-2"></i>
            Recent Stock Movements
          </h5>
        </div>
        <div class="card-body p-0">
          {% if recent_movements %}
          <div class="list-group list-group-flush">
            {% for movement in recent_movements %}
            <div class="list-group-item">
              <div class="d-flex justify-content-between align-items-start">
                <div>
                  <strong>
                    {{ movement.item.name }}</strong>
                  <br>
                  <small class="text-muted">
                    {{ movement.get_movement_type_display }} -
                    {{ movement.reason }}
                  </small>
                </div>
                <div class="text-end">
                  <span class="badge {% if movement.movement_type == 'IN' %}bg-success{% else %}bg-danger{% endif %}">
                    {% if movement.movement_type == 'IN' %}+{% else %}-{% endif %}
                    {{ movement.quantity }}
                  </span>
                  <br>
                  <small class="text-muted">
                    {{ movement.created_at|date:"M d, H:i" }}</small>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
          {% else %}
          <div class="p-3 text-center text-muted">
            <i class="fas fa-box-open fa-2x mb-2"></i>
            <p class="mb-0">No recent stock movements</p>
          </div>
          {% endif %}
        </div>
        <div class="card-footer">
          <a href="{% url 'inventory:reports' %}" class="btn btn-sm btn-outline-info">
            View All Movements
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Navigation -->
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">
            <i class="fas fa-compass text-primary me-2"></i>
            Quick Navigation
          </h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-3 mb-3">
              <a href="{% url 'inventory:item_list' %}" class="btn btn-outline-primary w-100 h-100 d-flex flex-column justify-content-center">
                <i class="fas fa-list fa-2x mb-2"></i>
                <span>All Items</span>
              </a>
            </div>
            <div class="col-md-3 mb-3">
              <a href="{% url 'inventory:item_create' %}" class="btn btn-outline-success w-100 h-100 d-flex flex-column justify-content-center">
                <i class="fas fa-plus fa-2x mb-2"></i>
                <span>Add Item</span>
              </a>
            </div>
            <div class="col-md-3 mb-3">
              <a href="{% url 'inventory:supplier_list' %}" class="btn btn-outline-info w-100 h-100 d-flex flex-column justify-content-center">
                <i class="fas fa-truck fa-2x mb-2"></i>
                <span>Suppliers</span>
              </a>
            </div>
            <div class="col-md-3 mb-3">
              <a href="{% url 'inventory:reports' %}" class="btn btn-outline-secondary w-100 h-100 d-flex flex-column justify-content-center">
                <i class="fas fa-chart-bar fa-2x mb-2"></i>
                <span>Reports</span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}